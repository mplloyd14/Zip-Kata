angular.module("lux.user",[]);
angular.module("lux.directives",["lux.templates","lux.services","lux.filters"]).run(["$rootScope","$window",function(e,n){"use strict";angular.forEach(["resize","scroll"],function(l){angular.element(n).bind(l,function(n){e.$broadcast(l,{$event:n})})})}]);
angular.module("lux.templates",[]).run(["$templateCache",function(n){n.put("common/directives/breadcrumb/breadcrumb.html",'<ul class="breadcrumb">\n    <li ng-repeat="route in crumbs">\n        <a href="" ng-href="{{ route.path }}" ng-class="{ disabled: $last }">{{ route.label }}</a>\n    </li>\n</ul>\n<!-- /.breadcrumb -->\n'),n.put("common/directives/table/table.html",'<table class="table table-bordered" data-height="{{ options.tbody.height }}" lux-fixed-table-header>\n    <thead>\n        <tr>\n            <th ng-repeat="column in columns" ng-click="options.thead.onclick($event, column, options.columns.indexOf(column))"  ng-class="{ link: !!options.thead.onclick }">\n                {{ options.thead.rename[column] || column | type : "string" : "title" }}\n            </th>\n        </tr>\n    </thead>\n    <tbody>\n        <tr ng-repeat="item in data">\n            <td ng-repeat="column in columns">\n                <a href="" ng-click="options.columns[column].onclick($event, item[column], column, data.indexOf(item))" ng-show="isButton(options.columns[column])" ng-class="setGetButtonClass(options.columns[column])">\n                    <i ng-show="hasIcon(options.columns[column])" ng-class="options.columns[columns].icon"></i>\n                    {{ options.columns[column].text || item[column] }}\n                </a>\n                <span ng-hide="isButton(options.columns[column])">\n                    {{ item[column] | type : options.columns[column].type : item[column].fmt }}\n                </span>\n            </td>\n        </tr>\n    </tbody>\n</table>\n')}]);
angular.module("lux.filters",[]);
angular.module("lux.services",[]);
angular.module("lux.user").factory("luxUser",[function(){"use strict";var e={},r={};return user.products.forEach(function(e){"productCode"===e.code&&((r=e).privileges=r.roles.concat(Object.keys(r.settings.permissions).filter(function(e){return r.settings.permissions[e]})))}),e.hasPrivilege=function(e){return r.privileges.indexOf(e)>0},e.hasSomePrivileges=function(r){for(var i=0,n=r.length;n>i;i++)if(e.hasPrivilege(r[i]))return!0;return!1},e.hasAllPrivileges=function(r){for(var i=0,n=r.length;n>i;i++)if(!e.hasPrivilege(r[i]))return!1;return!0},e}]);
angular.module("lux.directives").value("crumbs",[]).directive("luxBreadcrumb",["$route","$routeParams","$location","crumbs",function(r,e,t,a){"use strict";function n(r,e){for(var t=0,n=a.length;n>t;t++){var u=a[t];if(u.label===r&&u.originalPath===e)return t}return-1}function u(r,t){return t.useParam?e[r.substr(1)]:t.label||r}function i(e){var i=r.routes[e].breadcrumb;if(angular.isObject(i))for(var l=t.path(),c=e.split("/"),o=0,s=c.length,b=0,m=void 0;s>o;o++)if(m=u(c[o],i),b=n(m,e),m&&m.length){if(-1!==b){a.splice(b+1);break}a.push({label:m,path:l,originalPath:e})}}function l(e){var n="",i="",l=e.split("/"),o=t.path().split("/"),s=0,b=l.length;for(a.splice(0);b>s;s++)(l[s]||0===s)&&(l[s]&&(n+="/"+l[s],i+="/"+o[s]),a.push({label:u(l[s],r.routes[n||"/"].breadcrumb),path:c&&l[s]?c+i:"/",originalPath:n||"/"}))}var c=angular.element(document.getElementsByTagName("base")).attr("href")||"";return{restrict:"E",templateUrl:"common/directives/breadcrumb/breadcrumb.html",replace:!0,link:function(r,e,t){var n=t.hasOwnProperty("dynamic");r.crumbs=a,r.$on("$routeChangeSuccess",function(r,e){(n?i:l)(e.$$route.originalPath)})}}}]);
angular.module("lux.directives").directive("luxGrid",["$log","$timeout","luxUtils",function(i,n,t){"use strict";function r(i,n){i.css("visibility","hidden");var e=i[0].clientWidth,o=0,d=Math.max(Math.floor(e/(n.width+n.margin)),1),a=1==d?n.margin/2:e%(n.width+n.margin)/2,c=[],s=i.children();for(o=0;d>o;o++)c.push(0);for(o=0;o<s.length;o++){var l=c.indexOf(t.getMinNum(c)),u=angular.element(s[o]);if(!u[0])return r(i,n);u.css({position:"absolute",width:n.width+"px",margin:n.margin/2+"px",top:c[l]+n.margin/2+"px",left:(n.width+n.margin)*l+a+"px",visibility:"visible"}),c[l]+=u[0].clientHeight+n.margin}i.css({height:t.getMaxNum(c)+"px",visibility:"visible"})}var e={width:240,margin:10},o=["DOMNodeInserted","DOMNodeRemoved"];return{restrict:"E",link:function(i,t,d){var a=angular.copy(e);for(var c in a)d.hasOwnProperty(c)&&(a[c]=parseInt(d[c]));i.renderGrid=function(){n(function(){r(t,a)})},o.forEach(function(n){t.bind(n,function(){i.renderGrid()})}),i.$on("resize",i.renderGrid),i.$on("$destroy",function(){o.forEach(function(i){t.off(i)})})}}}]).directive("cell",[function(){"use strict";return{restrict:"E",transclude:!0,template:"<div ng-transclude></div>",compile:function(i){i.css("visibility","hidden")}}}]);
angular.module("lux.directives").directive("luxTable",[function(){"use strict";return{restrict:"E",scope:{data:"=?ngModel",opt:"&options"},controller:["$scope",function(t){t.hasIcon=function(t){return!!t.icon},t.isButton=function(t){return"link"===t.type||"button"===t.type},t.setGetButtonClass=function(t){return("button"===t.type?["btn","btn-block"]:[]).concat(angular.isArray(t["class"])?t["class"]:[t["class"]])}}],templateUrl:"common/directives/table/table.html",link:function(t){for(var e=t.opt(),n=Object.keys(e.columns),l=n.length-1,o=void 0;l>=0;l--)o=n[o],angular.isString(e.columns[o])&&(e.columns[o]={type:e.columns[o]||"string"}),e.columns[o]&&angular.isFunction(e.columns[o].filter)&&!e.columns[o].filter()&&n.splice(l,1);t.columns=n,t.options=e}}}]).directive("luxFixedTableHeader",["$timeout","luxUtils",function(t,e){"use strict";function n(t,e){var n=angular.element(t.querySelectorAll("thead, tbody, tfoot"));n.css("display",""),e&&angular.element(n[1]).css({height:e,overflow:"auto"});var o=n[0].querySelectorAll("tr > th"),i=o.length;angular.forEach(o,function(t,e){var o=n[1].querySelector("td:nth-child("+(e+1)+")"),r=n[2]&&n[2].querySelector("td:nth-child("+(e+1)+")"),c=o?o.offsetWidth:t.offsetWidth;t&&(t.style.width=c+"px"),o&&(o.style.width=(e===i-1?c-l:c)+"px"),r&&(r.style.width=c+"px")}),n.css("display","block")}var l=e.getScrollBarWidth();return{restrict:"A",link:function(e,l,o){t(function(){n(l[0],o.height||"inherit")}),e.$on("resize",function(){n(l[0])})}}}]);
angular.module("lux.filters").filter("startFrom",[function(){"use strict";return function(r,t){return r.slice(parseInt(t))}}]);
angular.module("lux.filters").filter("truncate",[function(){"use strict";var t="...";return function(r,e,n){if(e&&isNaN(e))throw new Error("Incorrect argument type. Expected integer.");return e=e?Math.abs(parseInt(e)):10,n=n||t,r.length>e?r.substring(0,e-n.length)+n:r}}]);
angular.module("lux.filters").filter("type",["$filter",function(t){"use strict";function e(t){return"String"==typeof t?"-"===t.charAt(0):0>t}function r(t){return a.test(t)}function n(t){return u.test(t)}function i(t){return o.test(t)}var a=/^[+|-]?\d\.?\d{0,}[E|e|X|x](10)?[\^\*]?[+|-]?\d+$/,o=/^0[0-7]{3}$/,u=/0[xX][0-9a-fA-F]+/,s={};return s["int"]=function(t){if(isNaN(t))throw new Error("Attempting to convert a string that is not a number to type int.");return parseInt(t,n(t)&&16||i(t)&&8||10)},s.uint=function(t){if(e(t))throw new Error("Attempting to convert a negative to a positive. Please enter positive number only for field type uint.");return Math.abs(s["int"](t))},s["float"]=function(t){if(isNaN(t))throw new Error("Attempting to convert a string that is not a number to type float.");if(r(t)){var e=t.toString().split("e"),n=Math.abs(e[1])+e[0].split(".")[1].length;return parseFloat(t).toFixed(n)}return parseFloat(t)},s.number=function(e,r){return"currency"===r?t("currency")(s["float"](e)):t("number")(s["float"](e),r)},s.date=function(e,r){return t("date")(e,r||"mediumDate")},s.string=function(e,r){switch(r){case"capitalize":return e.length?e[0].toUpperCase()+e.slice(1):e;case"title":return e.split(/\s+/).map(function(t){return s.string(t,"capitalize")}).join(" ");case"uppercase":case"lowercase":return t(r)(e);default:return e}},function(t,e,r){return s.hasOwnProperty(e)?s[e](t,r):t}}]);
angular.module("lux.services").factory("luxUtils",[function(){var t={};return t.getMaxNum=function(t){return Math.max.apply(null,angular.isArray(t)?t:arguments)},t.getMinNum=function(t){return Math.min.apply(null,angular.isArray(t)?t:arguments)},t.getScrollBarWidth=function(){var t=document.createElement("p");t.style.width="100%",t.style.height="200px";var e=document.createElement("div");e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.visibility="hidden",e.style.width="200px",e.style.height="150px",e.style.overflow="hidden",e.appendChild(t),document.body.appendChild(e);var l=t.offsetWidth;e.style.overflow="scroll";var n=t.offsetWidth;return l==n&&(n=e.clientWidth),document.body.removeChild(e),l-n},t}]);
